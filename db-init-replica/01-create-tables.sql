CREATE EXTENSION IF NOT EXISTS pgcrypto;

CREATE TABLE t1 (
    id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    operation_date DATE NOT NULL,
    amount NUMERIC(15,2) NOT NULL,
    status SMALLINT NOT NULL DEFAULT 0,
    operation_guid UUID NOT NULL,
    message JSONB NOT NULL
) PARTITION BY RANGE (operation_date);

CREATE TABLE t1_oct2025 PARTITION OF t1 FOR VALUES FROM ('2025-10-01') TO ('2025-11-01');
CREATE TABLE t1_nov2025 PARTITION OF t1 FOR VALUES FROM ('2025-11-01') TO ('2025-12-01');
CREATE TABLE t1_dec2025 PARTITION OF t1 FOR VALUES FROM ('2025-12-01') TO ('2026-01-01');
CREATE TABLE t1_jan2026 PARTITION OF t1 FOR VALUES FROM ('2026-01-01') TO ('2026-02-01');

ALTER TABLE t1 ADD CONSTRAINT t1_pkey PRIMARY KEY (id, operation_date);